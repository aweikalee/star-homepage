var e=Object.assign;import{c as t,a,F as n,d as o,r as l,o as i,b as s,e as r,f as c,C as u,V as p,g as d,w as v,h,T as m,m as f,i as g,n as w,j as _,S as y,P as b,M as C,G as x,k as M,R as k,l as A,p as E,q as T,s as S,t as B,u as I,v as q,x as F}from"./vendor.54976301.js";!function(e=".",t="__import__"){try{self[t]=new Function("u","return import(u)")}catch(a){const n=new URL(e,location),o=e=>{URL.revokeObjectURL(e.src),e.remove()};self[t]=e=>new Promise(((a,l)=>{const i=new URL(e,n);if(self[t].moduleMap[i])return a(self[t].moduleMap[i]);const s=new Blob([`import * as m from '${i}';`,`${t}.moduleMap['${i}']=m;`],{type:"text/javascript"}),r=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(s),onerror(){l(new Error(`Failed to import: ${e}`)),o(r)},onload(){a(self[t].moduleMap[i]),o(r)}});document.head.appendChild(r)})),self[t].moduleMap={}}}("/assets/");const P="https://beian.miit.gov.cn",j="浙ICP备17005099号-2",D=[{title:"毛呆账簿",url:"https://ledger.maodai.site",description:"自用记账工具，目前只做了基础功能，扩展的功能以后需要用的时候再慢慢加。",points:[-46,75,-46,-75,44,-75,46,74,-14,84,-68,27,22,93,-86,-15,15,61,-52,-7,-23,74,-23,48,-23,22,-23,-51,7,-22,33,-22,20,-36,20,-66,5,-36,35,-36,5,-51,35,-51],lines:[3,0,0,1,1,2,2,3,4,5,6,7,8,9,10,11,11,12,12,13,14,16,15,16,16,17,18,19,20,21]},{title:"旅游手账",url:"https://tripnote.maodai.site",description:"行程制作及展示。针对制作行程单以及旅游过程中的诸多痛点进行了改善。",points:[-46,75,-46,-75,44,-75,46,74,-14,84,-68,27,22,93,-86,-15,15,61,-52,-7,-23,74,-23,48,-23,22,-23,-51,20,-23,5,-61,20,-50,35,-61],lines:[3,0,0,1,1,2,2,3,4,5,6,7,8,9,10,11,11,12,12,13,14,15,15,16,16,17,17,14]},{title:"毛呆's Blog",url:"https://blog.maodai.site",description:"技术博客，没啥文章。大多死于草稿箱（然后丢进了另一个加密的博客中给自己看）",points:[-44,-58,-57,-25,-42,9,-55,46,-13,26,8,28,37,53,42,14,52,-23,34,-59,0,10,0,-40,-18,-39,17,-39],lines:[0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,10,11,11,12,11,13]},{title:"Syncplayer 同步播放器",url:"https://syncplayer.maodai.site",description:"通过 WebSocket 解决异地同步观影，当前仅支持选择本地文件进行播放。",points:[-60,80,75,0,-60,-80,-30,24,15,0,-30,-24],lines:[0,1,1,2,2,0,3,4,4,5,5,3]},{title:"JavaScript 抽象相等比较",url:"https://aweikalee.github.io/abstract-equality-comparison/",description:"展示 JavaScript 抽象相等的比较过程，帮助新人更好理解隐式转换。",points:[-25,80,-28,-14,-68,-15,-84,18,74,69,44,87,19,57,74,15,55,-19,16,-1,-80,-45,-22,-45,-80,-75,-22,-75,80,-45,22,-45,80,-75,22,-75],lines:[0,1,1,2,2,3,4,5,5,6,6,7,7,8,8,9,10,11,12,13,14,15,16,17]},{title:"Github",url:"https://github.com/aweikalee",description:"aweikalee",points:[-52,59,-26,49,25,47,53,61,55,34,62,-13,18,-44,26,-94,84,-55,89,46,36,92,-58,82,-94,35,-91,-58,-29,-94,-26,-73,-55,-67,-74,-43,-48,-55,-25,-58,-17,-45,-61,-9,-53,34],lines:[]}],L=[[-15,83,-15,53,15,53,15,83,-1,52,2,20,-8,0,-43,-8,-23,18,-16,50,16,45,-9,20,0,62,-37,-93,-32,-39,-17,3,4,-4,22,-43,45,-93],[-15,83,-15,53,15,53,15,83,0,50,-7,29,-6,2,12,93,-29,74,-18,46,15,44,28,74,-13,91,-20,-86,-41,-36,-19,-1,8,6,17,-37,14,-93],[-15,83,-15,53,15,53,15,83,-1,51,-3,18,0,-1,-32,52,-29,20,-17,49,14,42,10,16,20,-15,-36,-96,-19,-50,-13,-5,10,-2,26,-47,36,-95],[-15,83,-15,53,15,53,15,83,-1,51,-9,21,-2,3,-16,89,-53,60,-16,46,16,44,52,37,3,32,-14,-93,-22,-39,-15,0,10,5,19,-38,31,-93],[-15,83,-15,53,15,53,15,83,-1,51,1,28,-8,1,-13,34,-42,33,-16,47,15,47,21,20,8,-11,-49,-92,-37,-41,-23,-1,4,4,35,-37,26,-92],[-15,83,-15,53,15,53,15,83,-1,51,-1,26,-7,2,16,10,-16,16,-17,47,17,43,6,13,6,54,18,-83,-25,-38,-18,2,11,0,9,-41,3,-91]];D.push({title:"关于我",url:"",description:t(n,null,[t("div",null,[a("我是毛呆，一名前端攻城狮。")]),t("div",null,[a("正在寻找杭州或上海的坑位，也欢迎技术交流，我的联系方式："),t("a",{href:"mailto:aweikalee@163.com"},[a("aweikalee@163.com")]),a("。")])]),points:L[Math.floor(Math.random()*L.length)],lines:[0,1,1,2,2,3,0,3,4,5,5,6,7,8,8,9,9,10,10,11,11,12,13,14,14,15,15,16,16,17,17,18]}),D.map((e=>{const{lines:t,points:a}=e;if(0===t.length){const e=Math.floor(a.length/2);for(let a=0;a<e;a+=1)t.push(0===a?e-1:a-1),t.push(a)}}));var Y="688";var R="450",z="800";const X={screenBoundary:{w:Number("1088"),h:Number(Y)},phone:{w:Number(R),h:Number(z)},fov:{base:30/360*2*Math.PI,mobile:{portrait:50/360*2*Math.PI,landscape:30/360*2*Math.PI}},constellation:{scale:.008,near:5,far:6},album:{imageQuality:2073600,thumbnailQuality:200}},O={root:document.getElementById("app"),overlay:document.getElementById("overlay")};var U="_footer_13vno_1",V=o({name:"TheFooter",setup:()=>()=>t("div",{class:U},[t("div",null,[a("DESIGN BY "),t("a",{href:"https://github.com/aweikalee"},[a("@AWEIKALEE (毛呆)")])]),t("div",null,[t("a",{href:P},[j])])])});var K="_phone_1jjyg_12",Q="_view_1jjyg_21",N="_footer_1jjyg_28",J="_border-top_1jjyg_42",H="_border-bottom_1jjyg_42",W="_border-left_1jjyg_42",G="_border-right_1jjyg_42",Z=o({name:"ThePhone",setup:(e,{slots:a})=>()=>{var e;return t("div",{class:K},[t("div",{class:Q},[null==(e=a.default)?void 0:e.call(a)]),t(V,{class:N},null),t("div",{class:J},null),t("div",{class:H},null),t("div",{class:W},null),t("div",{class:G},null)])}});function $(e,t,a){const n=a/t,o=Math.tan(e/2);return 2*Math.atan(n*o)}function ee(e){const t=document.createElement("canvas"),a=t.getContext("2d");return t.width=e.width,t.height=e.height,a.putImageData(e,0,0),t}function te(e,t,a){return new Promise((n=>{e.toBlob(n,t,a)}))}const ae=r({w:1,h:1,orientation:"portrait",isMobileInCSS:!1}),ne=c(ae),{w:oe,h:le}=X.screenBoundary,ie=()=>{const e=window.innerWidth,t=window.innerHeight;O.root.style.width=`${e}px`,O.root.style.height=`${t}px`,window.scrollTo({top:0}),ae.w=e>>1<<1,ae.h=t>>1<<1,ae.orientation=t>=e?"portrait":"landscape",ae.isMobileInCSS=e<oe||t<le};function se(e,t){return Math.random()*(t-e)+e}function re(e=3){let t=0;for(let a=0;a<e;a+=1)t+=Math.random();return t/e}function ce(e){const[t,a,n]=e,o=Math.max(...e),l=o-Math.min(...e),i=Math.PI/3;let s;return s=0===l?0:o===t?i*((a-n)/l%6):o===a?i*((n-t)/l+2):i*((t-a)/l+4),[s,0===o?0:l/o,o]}function ue(e,t){const a=new u(e),n=new u(t),o=ce(a),l=ce(n);return o[0]>l[0]&&(l[0]+=2*Math.PI),e=>function(e){const t=Math.PI/3,[a,n,o]=e,l=o*n,i=l*(1-Math.abs(a/t%2-1)),s=o-l,[r,c,u]=[[l,i,0],[i,l,0],[0,l,i],[0,i,l],[i,0,l],[l,0,i]][Math.floor(a/t%6)];return[r+s,c+s,u+s]}(o.map(((t,a)=>t*e+l[a]*(1-e))))}ie(),addEventListener("resize",((e,t=100)=>{let a;return(...n)=>{void 0===a&&(a=setTimeout((()=>{e(...n),a=void 0}),t))}})(ie));let pe=!1;const de={onDragstart:function(e){pe=!0,e.preventDefault()},onClick:function(e){pe&&e.preventDefault(),pe=!1},onTouchStart:function(e){e.stopPropagation()}},ve=[0,3e3,1e4];var he,me;(me=he||(he={}))[me.NO_STATUS=0]="NO_STATUS",me[me.TAKING=1]="TAKING",me[me.TAKED=2]="TAKED";const fe=r({visible:{album:!1,balance:!1,constellation:!0,list:!1,timer:!1},setVisible(e,t){fe.visible[e]=t},toggleVisible(e){fe.setVisible(e,!fe.visible[e])},balance:new p(1,1,1),setBalance(e){fe.balance=e},delay:ve[0],setDelay(e){fe.delay=e},toggleDelay(){const e=ve.indexOf(fe.delay)+1;fe.setDelay(ve[e%ve.length])},desaturate:!1,setDesaturate(e){fe.desaturate=e},frontCamera:!1,setFrontCamera(e){fe.frontCamera=e},toggleFrontCamera(){fe.setFrontCamera(!fe.frontCamera)},state:0,setState(e){fe.state=e}}),ge=c(fe),we=r({fov:d((()=>{const{fov:e,phone:t}=X,{h:a,isMobileInCSS:n,orientation:o}=ne;return n?e.mobile[o]:$(e.base,t.w,a)})),w:d((()=>ne.w)),h:d((()=>ne.h))}),_e=r({fov:1,w:1,h:1,offsetX:0,offsetY:0}),ye=l(null);v((()=>e({el:ye.value},we)),(({el:e,fov:t,w:a,h:n})=>{if(!e)return;const o=e.getBoundingClientRect();_e.w=Math.floor(o.width),_e.h=Math.floor(o.height),_e.offsetX=Math.floor(o.x+o.width/2-a/2),_e.offsetY=Math.floor(o.y+o.height/2-n/2),_e.fov=$(t,n,_e.h)}));const be=d((()=>{const e=X.album.imageQuality,t=_e.w/_e.h,a=Math.sqrt(e*t)>>1<<1,n=a/t>>1<<1,o=a/_e.w,l=Math.floor(_e.offsetX*o),i=Math.floor(_e.offsetY*o),s=a+2*Math.abs(l),r=n+2*Math.abs(i);return{outputW:a,outputH:n,offsetX:l,offsetY:i,w:s,h:r,fov:$(_e.fov,n,r)}})),Ce=c(r({full:we,camera:_e,photo:be,setCameraElement:function(e){ye.value=e}})),xe=-1,Me=0,ke=1,Ae=2,Ee=3,Te=new p,Se=new h,Be=new h;const Ie=d((()=>{const{h:e,fov:t}=Ce.full,a=e/(2*Math.tan(t/2));return(e,t,n)=>({x:e/n*a,y:-t/n*a})})),qe=r({toPx:Ie,camera:new m}),Fe=c(qe),Pe=new m;Pe.position.set(0,0,1);const je=new function(e,{element:t=document.body,enabled:a=!0,target:n=new p,ease:o=.25,inertia:l=.85,enableRotate:i=!0,rotateSpeed:s=.1,autoRotate:r=!1,autoRotateSpeed:c=1,enableZoom:u=!0,zoomSpeed:d=1,enablePan:v=!0,panSpeed:m=.1,minPolarAngle:f=0,maxPolarAngle:g=Math.PI,minAzimuthAngle:w=-1/0,maxAzimuthAngle:_=1/0,minDistance:y=0,maxDistance:b=1/0}={}){this.enabled=a,this.target=n,o=o||1,l=l||0,this.minDistance=y,this.maxDistance=b;const C={radius:1,phi:0,theta:0},x={radius:1,phi:0,theta:0},M={radius:1,phi:0,theta:0},k=new p,A=new p;A.copy(e.position).sub(this.target),M.radius=x.radius=A.distance(),M.theta=x.theta=Math.atan2(A.x,A.z),M.phi=x.phi=Math.acos(Math.min(Math.max(A.y/x.radius,-1),1)),this.offset=A,this.update=()=>{r&&B===xe&&function(){const e=2*Math.PI/60/60*c;C.theta-=e}(),x.radius*=C.radius,x.theta+=C.theta,x.phi+=C.phi,x.theta=Math.max(w,Math.min(_,x.theta)),x.phi=Math.max(f,Math.min(g,x.phi)),x.radius=Math.max(this.minDistance,Math.min(this.maxDistance,x.radius)),M.phi+=(x.phi-M.phi)*o,M.theta+=(x.theta-M.theta)*o,M.radius+=(x.radius-M.radius)*o,this.target.add(k);let t=M.radius*Math.sin(Math.max(1e-6,M.phi));A.x=t*Math.sin(M.theta),A.y=M.radius*Math.cos(M.phi),A.z=t*Math.cos(M.theta),e.position.copy(this.target).add(A),e.lookAt(this.target),C.theta*=l,C.phi*=l,k.multiply(l),C.radius=1},this.forcePosition=()=>{A.copy(e.position).sub(this.target),M.radius=x.radius=A.distance(),M.theta=x.theta=Math.atan2(A.x,A.z),M.phi=x.phi=Math.acos(Math.min(Math.max(A.y/x.radius,-1),1)),e.lookAt(this.target)};const E=new h,T=new h,S=new h;let B=xe;function I(){return Math.pow(.95,d)}this.mouseButtons={ORBIT:0,ZOOM:1,PAN:2};const q=(a,n)=>{Te.copy(e.position).sub(this.target);let o=Te.distance();var l,i;o*=Math.tan((e.fov||45)/2*Math.PI/180),l=2*a*o/t.clientHeight,i=e.matrix,Te.set(i[0],i[1],i[2]),Te.multiply(-l),k.add(Te),function(e,t){Te.set(t[4],t[5],t[6]),Te.multiply(e),k.add(Te)}(2*n*o/t.clientHeight,e.matrix)};function F(e){C.radius/=e}function P(e,a){Se.set(e,a),Be.sub(Se,E).multiply(s),C.theta-=2*Math.PI*Be.x/t.clientHeight,C.phi-=2*Math.PI*Be.y/t.clientHeight,E.copy(Se)}function j(e,t){Se.set(e,t),Be.sub(Se,T).multiply(m),q(Be.x,Be.y),T.copy(Se)}const D=e=>{if(this.enabled){switch(e.button){case this.mouseButtons.ORBIT:if(!1===i)return;E.set(e.clientX,e.clientY),B=Me;break;case this.mouseButtons.ZOOM:if(!1===u)return;S.set(e.clientX,e.clientY),B=ke;break;case this.mouseButtons.PAN:if(!1===v)return;T.set(e.clientX,e.clientY),B=Ae}B!==xe&&(window.addEventListener("mousemove",L,!1),window.addEventListener("mouseup",Y,!1))}},L=e=>{if(this.enabled)switch(B){case Me:if(!1===i)return;P(e.clientX,e.clientY);break;case ke:if(!1===u)return;!function(e){Se.set(e.clientX,e.clientY),Be.sub(Se,S),Be.y>0?F(I()):Be.y<0&&F(1/I()),S.copy(Se)}(e);break;case Ae:if(!1===v)return;j(e.clientX,e.clientY)}},Y=e=>{window.removeEventListener("mousemove",L,!1),window.removeEventListener("mouseup",Y,!1),B=xe},R=e=>{this.enabled&&u&&(B===xe||B===Me)&&(e.stopPropagation(),e.preventDefault(),e.deltaY<0?F(1/I()):e.deltaY>0&&F(I()))},z=e=>{if(this.enabled)switch(e.preventDefault(),e.touches.length){case 1:if(!1===i)return;E.set(e.touches[0].pageX,e.touches[0].pageY),B=Me;break;case 2:if(!1===u&&!1===v)return;!function(e){if(u){let t=e.touches[0].pageX-e.touches[1].pageX,a=e.touches[0].pageY-e.touches[1].pageY,n=Math.sqrt(t*t+a*a);S.set(0,n)}if(v){let t=.5*(e.touches[0].pageX+e.touches[1].pageX),a=.5*(e.touches[0].pageY+e.touches[1].pageY);T.set(t,a)}}(e),B=Ee;break;default:B=xe}},X=e=>{if(this.enabled)switch(e.preventDefault(),e.stopPropagation(),e.touches.length){case 1:if(!1===i)return;B===xe&&(B=Me,E.set(e.touches[0].pageX,e.touches[0].pageY)),P(e.touches[0].pageX,e.touches[0].pageY);break;case 2:if(!1===u&&!1===v)return;!function(e){if(u){let t=e.touches[0].pageX-e.touches[1].pageX,a=e.touches[0].pageY-e.touches[1].pageY,n=Math.sqrt(t*t+a*a);Se.set(0,n),Be.set(0,Math.pow(Se.y/S.y,d)),F(Be.y),S.copy(Se)}v&&j(.5*(e.touches[0].pageX+e.touches[1].pageX),.5*(e.touches[0].pageY+e.touches[1].pageY))}(e);break;default:B=xe}},O=()=>{this.enabled&&(B=xe)},U=e=>{this.enabled&&e.preventDefault()};this.remove=function(){t.removeEventListener("contextmenu",U),t.removeEventListener("mousedown",D),t.removeEventListener("wheel",R),t.removeEventListener("touchstart",z),t.removeEventListener("touchend",O),t.removeEventListener("touchmove",X),window.removeEventListener("mousemove",L),window.removeEventListener("mouseup",Y)},t.addEventListener("contextmenu",U,!1),t.addEventListener("mousedown",D,!1),t.addEventListener("wheel",R,{passive:!1}),t.addEventListener("touchstart",z,{passive:!1}),t.addEventListener("touchend",O,!1),t.addEventListener("touchmove",X,{passive:!1})}(Pe,{element:document.getElementById("app"),ease:.5,enableZoom:!1,enablePan:!1,rotateSpeed:-.03,autoRotate:!0,autoRotateSpeed:.06,minPolarAngle:Math.PI/2-X.fov.base/2,maxPolarAngle:Math.PI/2+X.fov.base/2});!function e(){requestAnimationFrame(e),je.update(),qe.camera.lookAt(Pe.position),ge.frontCamera&&(qe.camera.rotation.y+=Math.PI,qe.camera.rotation.x*=-1)}();const De=X.fov.base,Le=2*Math.PI/D.length,Ye=D.map(((t,a)=>{const n=function(e){const t=Math.floor(e.length/2),a=new Float32Array(3*t),{constellation:{scale:n,near:o,far:l}}=X;for(let i=0;i<t;i+=1){const t=2*i,s=[e[t],e[t+1],-se(o,l)/n].map((e=>e*n));a.set(s,3*i)}return a}(t.points),o=function(e,t){const a=2*Math.floor(e.length/2),n=new Float32Array(3*a);for(let o=0;o<a;o+=1){const a=3*e[o],l=[t[a],t[a+1],t[a+2]];n.set(l,3*o)}return n}(t.lines,n);return e(e({},t),{points:n,lines:o,rotationY:Le*a,rotationX:De*se(-.5,.5)})})),Re=d((()=>{const{w:e,h:t,fov:a}=Ce.camera;return{x:a,y:$(a,t,e)}})),ze=d((()=>{const{x:e,y:t}=Fe.camera.rotation,a=function(e,t){const a=e%t;return a<0?a+t:a}(t+Le/2,2*Math.PI),n=Math.floor(a/Le),o=Ye[n],l=Re.value;return Math.abs(o.rotationY+Le/2-a)>l.y/2||Math.abs(o.rotationX-e)>l.x/2?null:o})),Xe=c(r({data:Ye,focus:ze}));const Oe=r({photos:[],async pushPhoto(t){const a=await function(e){const t=new Promise((t=>{const a=new Image;a.width=e.w,a.height=e.h,a.onload=()=>t(a),a.src=e.src}));return new Promise((async e=>{const a=function(e,t){const a=document.createElement("canvas"),n=a.getContext("2d");let o=e.width,l=e.height;return t/o*l>=t?(l=Math.round(t/o*l),o=t):(o=Math.round(t/l*o),l=t),a.width=o,a.height=l,n.drawImage(e,0,0,o,l),a}(await t,X.album.thumbnailQuality),n=await te(a);e(URL.createObjectURL(n))}))}(t);Oe.photos.push(e(e({},t),{msrc:a}))},buttonElement:null,setButtonElement(e){Oe.buttonElement=e}}),Ue=c(Oe);var Ve={balance:t("svg",f({viewBox:"0 0 600 600",fill:"currentColor"},{xmlns:"http://www.w3.org/2000/svg"}),[t("circle",{cx:"211",cy:"385",r:"170",opacity:"0.3"},null),t("circle",{cx:"300",cy:"215",r:"170",opacity:"0.6"},null),t("circle",{cx:"389",cy:"385",r:"170",opacity:"0.9"},null)]),camera:t("svg",f({viewBox:"0 0 600 600"},{xmlns:"http://www.w3.org/2000/svg"},{fill:"none"}),[t("polygon",{points:"30 130 160 130 220 60 380 60 440 130 570 130 570 530 30 530",stroke:"currentColor","stroke-width":"40","stroke-linejoin":"round",opacity:"0.5"},null),t("line",{x1:"50",y1:"70",x2:"120",y2:"70",stroke:"currentColor","stroke-width":"40",opacity:"0.5"},null),t("path",{d:"M 210 250 a 110 110 0 0 1 200 60 t -50 0",stroke:"currentColor","stroke-width":"40","stroke-linecap":"round"},null),t("path",{d:"M 390 380 a 110 110 0 0 1 -200 -60 t 50 0",stroke:"currentColor","stroke-width":"40","stroke-linecap":"round"},null)]),close:t("svg",f({viewBox:"0 0 600 600",fill:"currentColor"},{xmlns:"http://www.w3.org/2000/svg"}),[t("line",{x1:"120",y1:"120",x2:"480",y2:"480",stroke:"currentColor","stroke-width":"80","stroke-linecap":"round"},null),t("line",{x1:"480",y1:"120",x2:"120",y2:"480",stroke:"currentColor","stroke-width":"80","stroke-linecap":"round"},null)]),constellation:t("svg",f({viewBox:"0 0 600 600"},{xmlns:"http://www.w3.org/2000/svg"}),[t("polygon",{points:"228 -74 114 37 141 194 0 120 -141 194 -114 37 -228 -74 -71 -97 0 -240 71 -97",stroke:"currentColor","stroke-width":"40",transform:"translate(300, 300)"},null)]),list:t("svg",f({id:"c881b985-35f8-419f-837d-9f19c1339a61","data-name":"图鉴",viewBox:"0 0 600 600"},{xmlns:"http://www.w3.org/2000/svg"}),[t("defs",null,[t("clipPath",{id:"823cb2cd-fb39-45ac-852d-f490dffa35d5"},[t("rect",{x:"460",y:"0",width:"100",height:"600"},null),t("rect",{x:"0",y:"532",width:"600",height:"100"},null)])]),t("rect",{x:"100",y:"32",rx:"40",ry:"40",width:"320",height:"460",stroke:"currentColor","stroke-width":"40"},null),t("rect",{x:"170",y:"102",rx:"40",ry:"40",width:"320",height:"460",stroke:"currentColor","stroke-width":"40","clip-path":"url(#823cb2cd-fb39-45ac-852d-f490dffa35d5)"},null),t("polygon",{points:"114 -37 57 19 71 97 0 60 -71 97 -57 19 -114 -37 -35 -49 0 -120 35 -49",stroke:"currentColor","stroke-width":"20",transform:"translate(260, 262)"},null)]),timer:t("svg",f({viewBox:"0 0 600 600"},{xmlns:"http://www.w3.org/2000/svg"}),[t("path",{d:"M 140 135 A 229 229 0 0 0 70 300 c 0 127 103 230 230 230 S 530 427 530 300 427 70 300 70 v 65",stroke:"currentColor","stroke-linecap":"round","stroke-miterlimit":"20","stroke-width":"40"},null),t("path",{d:"M322 278 a 31 31 0 0 1 -44 44 C 266 310 192 192 192 192 S 310 266 322 278 Z",fill:"currentColor"},null)])};var Ke="_icon_zi5ua_1",Qe=o({name:"Icon",props:{value:{type:String,required:!0}},setup:e=>()=>t("span",{class:Ke},[e.value&&Ve[e.value]])});var Ne="_camera_1ajcg_7",Je="_toolbar_1ajcg_16",He="_item_1ajcg_28",We="_button_1ajcg_34",Ge="_description_1ajcg_49",Ze="_view_1ajcg_53",$e="_shutterbar_1ajcg_58",et="_album_1ajcg_69",tt="_album__button_1ajcg_76",at="_shutter_1ajcg_58",nt="_shutter__button_1ajcg_91",ot="_switch_1ajcg_119",lt="_switch__button_1ajcg_126",it="_scale-in--active_1ajcg_160",st="_scale-in--from_1ajcg_164",rt="_scale-in--to_1ajcg_168",ct="_mask_1ajcg_172",ut="_fade-in--active_1ajcg_182",pt="_fade-in--from_1ajcg_186",dt="_fade-in--to_1ajcg_190",vt="_timer_1ajcg_195";const ht=o({name:"TheCameraToolBarItem",props:{active:{type:Boolean,default:!1},title:{type:String},onClick:{type:Function}},setup:(e,{slots:a})=>()=>{var n;return t("div",{class:He},[t("div",f({title:e.title,class:We,"data-active":e.active},de,{onClick:t=>{var a;de.onClick(t),null==(a=e.onClick)||a.call(e,t)}}),[null==(n=a.default)?void 0:n.call(a)])])}});var mt=o({name:"TheCameraToolBar",setup:()=>()=>t("div",{class:Je},[t(ht,{title:"显示星座",active:ge.visible.constellation,onClick:()=>{ge.toggleVisible("constellation")}},{default:()=>t(Qe,{value:"constellation"},null)}),t(ht,{title:"延时",active:!!ge.delay,onClick:()=>{ge.toggleDelay()}},{default:()=>t(n,null,[t(Qe,{value:"timer"},null),ge.delay?t("span",{class:Ge},[ge.delay/1e3,a("秒")]):null])}),t(ht,{title:"色彩平衡",onClick:()=>{ge.toggleVisible("balance")}},{default:()=>t(Qe,{value:"balance"},null)}),t(ht,{title:"星座图鉴",onClick:()=>{ge.toggleVisible("list")}},{default:()=>t(Qe,{value:"list"},null)})])}),ft=o({name:"TheCameraTimer",props:{onTimeUp:Function},setup(e){const a=ge.delay,n=Date.now(),o=r({delay:a,startTime:n,endTime:n+a});let l;const c=()=>{var t;const a=Date.now(),n=o.endTime-o.delay+1e3;a>=o.endTime?null==(t=e.onTimeUp)||t.call(e):l=setTimeout((()=>{o.delay-=1e3,c()}),n-a)};i(c),s((()=>clearTimeout(l)));const u=d((()=>Math.floor(o.delay/1e3)));return()=>t("div",{class:vt,key:u.value},[u.value])}}),gt=o({name:"TheCamera",setup(e,{slots:a}){const n=r({albumButtonVisible:!0,shutterMask:!1}),o=d((()=>{var e;const t=Ue.photos[Ue.photos.length-1];return null!=(e=null==t?void 0:t.msrc)?e:null==t?void 0:t.src}));v(o,(()=>{n.albumButtonVisible=!1,w((()=>n.albumButtonVisible=!0))}));const i=()=>{ge.setVisible("timer",!1),ge.setState(he.TAKING)},c=l();v(c,(e=>Ue.setButtonElement(null!=e?e:null))),s((()=>Ue.setButtonElement(null)));const u=l();return v(u,(e=>Ce.setCameraElement(null!=e?e:null))),s((()=>Ce.setCameraElement(null))),()=>{var e;return t("div",{class:Ne},[t(mt,null,null),t("div",{class:Ze,ref:u},[null==(e=a.default)?void 0:e.call(a),ge.visible.timer&&t(ft,{onTimeUp:i},null)]),t("div",{class:$e},[t("div",{class:et},[t(g,{enterActiveClass:it,enterFromClass:st,enterToClass:rt},{default:()=>n.albumButtonVisible&&t("div",f({title:"相册",class:tt,style:{backgroundImage:o.value?`url(${o.value})`:void 0}},de,{onClick:e=>{de.onClick(e),ge.setVisible("album",!0)},ref:c}),null)})]),t("div",{class:at},[t("div",f({title:"快门",class:nt,"data-active":ge.visible.timer},de,{onClick:e=>{de.onClick(e),ge.toggleVisible("timer")}}),null)]),t("div",{class:ot},[t("div",f({title:"切换摄像头",class:lt},de,{onClick:e=>{de.onClick(e),ge.toggleFrontCamera()}}),[t(Qe,{value:"camera"},null)])])]),t(g,{leaveActiveClass:ut,leaveFromClass:pt,leaveToClass:dt},{default:()=>ge.state===he.TAKING&&t("div",{class:ct},null)})])}}});class wt{constructor(e={}){const{canvas:t=document.createElement("canvas"),width:a=100,height:n=100}=e;this.canvas=t;const o=this.ctx=t.getContext("2d");t.width=a,t.height=n,o.translate(a/2,n/2)}save(){return this.ctx.save(),this}restore(){return this.ctx.restore(),this}setStyles(e){const{x:t,y:a,rotate:n,scaleX:o,scaleY:l,opacity:i,fill:s,stroke:r,strokeWidth:c}=e,{ctx:u}=this;return void 0===t&&void 0===a||u.translate(null!=t?t:0,null!=a?a:0),n&&u.rotate(n),void 0===o&&void 0===l||u.scale(null!=o?o:1,null!=l?l:1),void 0!==i&&(u.globalAlpha=i),void 0!==s&&(u.fillStyle=s),void 0!==r&&(u.strokeStyle=r),void 0!==c&&(u.lineWidth=c),this}wrapper(e,t){return t&&(this.save(),this.setStyles(t)),e(),t&&this.restore(),this}drawImage(e,t){return this.wrapper((()=>{const{ctx:t}=this;t.drawImage(e,-e.width/2,-e.height/2)}),t)}rect({w:e,h:t},a){return this.wrapper((()=>{const{ctx:a}=this;a.beginPath(),a.rect(-e/2,-t/2,e,t),a.closePath(),a.fill()}),a)}circle({radius:e},t){return this.wrapper((()=>{const{ctx:t}=this;t.beginPath(),t.arc(0,0,e,0,2*Math.PI),t.closePath(),t.fill()}),t)}}let _t;function yt(e){return _t||(_t=new _(e),async function(){const e=2048,t=2*e,a=new wt({width:t,height:e});return a.rect({w:t,h:e},{fill:"#000"}),a.wrapper((()=>{[10573005,26276].forEach((n=>{Mt(a,{image:Ct(new u(n)),width:t,height:e,quantity:20,x:()=>Math.random(),y:()=>Math.random(),scale:()=>100*se(.5,1),fy:()=>1})}))}),{opacity:.1}),a.wrapper((()=>{Mt(a,{image:Ct(new u(2603122)),width:t,height:614.4,quantity:20,x:()=>re(2),y:()=>Math.random(),scale:()=>50*se(.5,1)})}),{opacity:.15}),a.wrapper((()=>{Mt(a,{image:Ct(new u(16248018)),width:.9*t,height:100,quantity:200,x:()=>re(2),y:()=>Math.random(),scale:()=>15*se(.2,1)})}),{opacity:.3}),a.wrapper((()=>{Mt(a,{image:Ct(new u(16248018)),width:.3*t,height:200,quantity:100,x:()=>re(2),y:()=>Math.random(),scale:()=>15*se(.2,1)})}),{opacity:.3}),a.wrapper((()=>{Mt(a,{image:Ct(new u(16777215)),width:.9*t,height:70,quantity:300,x:()=>re(3),y:()=>Math.random()-.5,scale:()=>6*se(.1,1)})}),{opacity:.2}),a.wrapper((()=>{Mt(a,{image:Ct(new u(16777215)),width:.3*t,height:200,quantity:100,x:()=>re(3),y:()=>Math.random()-.5,scale:()=>10*se(.1,1)})}),{opacity:.15}),a.wrapper((()=>{const e=[[new u(1839365),1,.3],[new u(1839365),1,1.36],[new u(1839365),.4,1.1],[new u(1839365),2.9,1.1]];e.forEach((e=>{Mt(a,{image:xt(...e),width:t,height:50,quantity:300,x:()=>se(.05,.95),y:()=>re(2),scale:()=>1.5*se(.1,1)})})),Mt(a,{image:xt(...e[3]),width:2048,height:200,quantity:2e3,x:()=>re(3),y:()=>re(2),scale:()=>1.5*se(.1,1)})}),{opacity:.1}),a.wrapper((()=>{const t=Ct(new u(0)),n=t.width;let o=0;const l=[];for(;o<=e;){const e=40*Math.random();l.push(e),o+=e*n*.3}let i=-1024;l.forEach((e=>{a.drawImage(t,{x:-2048,y:i,rotate:e,scaleX:e,scaleY:e}),a.drawImage(t,{x:2048,y:i,rotate:e,scaleX:e,scaleY:e}),i+=e*n*.3}))}),{opacity:1}),function(){const n=[],o=ue(16744576,8421631);for(let e=0;e<20;e+=1){const t=`rgb(${o(e/19).map((e=>255*e)).join(",")})`;n.push(t)}function l(o,l){for(let i=0;i<o;i+=1)a.circle({radius:l/2},{fill:n[i%20],x:(Math.random()-.5)*t,y:(Math.random()-.5)*e})}l(1e4,1),l(1e3,2),l(1e3,3)}(),a.canvas}().then((e=>{_t.image=e}))),_t}const bt=[0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,3,5,5,7,4,4,1,1,0,1,0,0,0,0,0,1,0,0,17,27,41,52,56,34,23,15,11,4,9,5,1,0,0,0,0,0,0,1,45,63,57,45,78,66,52,41,34,37,23,20,0,1,0,0,0,0,1,43,62,66,64,67,115,112,114,56,58,47,33,18,12,10,0,0,0,0,39,50,63,76,87,107,105,112,128,104,69,64,29,18,21,15,0,0,0,7,42,52,85,91,103,126,153,128,124,82,57,52,52,24,1,0,0,0,2,17,41,67,84,100,122,136,159,127,78,69,60,50,47,25,7,1,0,0,0,34,33,66,82,113,138,149,168,175,82,142,133,70,62,41,25,6,0,0,0,18,39,55,113,111,137,141,139,141,128,102,130,90,96,65,37,0,0,0,2,15,27,71,104,129,129,158,140,154,146,150,131,92,100,67,26,3,0,0,0,0,46,73,104,124,145,135,122,107,120,122,101,98,96,35,38,7,2,0,0,0,50,58,91,124,127,139,118,121,177,156,88,90,88,28,43,3,0,0,0,0,30,62,68,91,83,117,89,139,139,99,105,77,32,1,1,0,0,0,0,0,16,21,8,45,101,125,118,87,110,86,64,39,0,0,0,0,0,0,0,0,0,1,28,79,79,117,122,88,84,54,46,11,0,0,0,0,0,0,0,0,0,1,0,6,55,61,68,71,30,16,0,0,0,0,0,0,0,0,0,0,0,0,0,0,14,23,25,20,12,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,12,9,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,2,2,0,0,0,0,0,0,0,0];function Ct(e){const[t,a,n]=e.map((e=>255*e)),o=new Uint8ClampedArray(1600);for(let l=0;l<400;l+=1){const e=4*l;o[e]=t,o[e+1]=a,o[e+2]=n,o[e+3]=bt[l]}return ee(new ImageData(o,20,20))}function xt(e,t,a){const n=document.createElement("canvas"),o=n.getContext("2d");n.width=50,n.height=50,o.fillStyle=`rgb(${e.map((e=>255*e)).join(",")}, 0.3)`;const l=2*Math.PI;for(let r=0;r<300;r+=1){const e=Math.random();var i=Math.cos(l*t/300*r)*e*25,s=Math.sin(l*a/300*r)*e*25;o.beginPath(),o.arc(i+25,s+25,3,0,l),o.fill()}return n}function Mt(e,t){const a=Math.PI,{image:n,width:o,height:l,quantity:i,x:s,y:r,scale:c,fy:u=(e=>Math.sin(e*a))}=t;for(let p=0;p<i;p+=1){const t=s(),i=r(),d=c();e.drawImage(n,{x:(t-.5)*o,y:(i-.5)*u(t,p)*l,rotate:Math.random()*a,scaleX:d,scaleY:d})}}let kt;function At(e){if(!kt){kt=new _(e);const t=new Image;t.onload=()=>kt.image=t,t.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAHKElEQVR4nL1b2XbbOhCDEjddctv+/2+2zdYm8X2oEMMwZkgv6ZzDQ0WWaAKzcDh0lu12i38gy4nvvfvkNhcaZymuu3szkgjYDj4/Ss4hYLH+lOskFUBeL8X1SWScQsCCDGgJn1e9v+uTd1Dab7EPXMfahvutLEfEgATcQc/e60RBbK2N7qUxWpm1gAqEg7wa3EPoddLebwG84hC03+N4aiE6VikzBIw0e9X0V+G5GQIc5Kv8/bqO9RqeS9KSMCLAwSbwDpjtOnyW3EIn6lpWkC9y7xU7jS/IVjJFQkdAB7oDXPVuIRUBClqBVz3H0veSRBIqAkYad+AzTd8ZEaDgq3Yl10oCjiEhETADXrV7vY7DfmN/s+fzagU+OWqR2n1er7VnUyJfwnhTJFQEOBmVxh34h6JXEpIVJO0r6D/Sk/xn7JP5ErCQhJQ4RQJSpO/AO9ibtfemVqHBMRFAs6am/0jbrL3O6U8A7iTo9+yRMEMASXDgBM12U7REAifvEyUBDv63tCqeVHHFiS4JSIlKZQEK/gbAR+m1ORFqBckCVPsO/CkQOFpKPXX2fhgEHbxrniA/rdefpPFvEqOW4ADU/1XzTyv4RyNQLUhJqNLlMjt0C1DtV77vJk/An9fm1yTDrUBBuPlT+08r+BsADziMIRXwlBhFIkhAivzu/+77qvHPAL5Y+yxNXeID9t2Ak6H5K/inFbiT56bPMTR71L8Vz96KkIKgm3+n/Y8C/taakkGiKiAkQLX/uDYnLmlfl0//W+85CWUQ9HRXLUDBq/ZvAfxnjUSoJdwMCKD2H9am73jcSGA9XebG6QqmfSWgW//Tuq8EfDICvkojCbdGgGoTMlk1/wcAdw34mXT52khQCyhdQInQlDctfckCvgL4HkigK3BFSEsYI/8jgPtAFifv+YK3DXbpMknwZR5A7QJVDHALYAwgCWoB3wF8w747XKOWBTv3+iJEUfvA4UqRmqbMagG+ysU8YOQC3RLoVvBN2pcGeJLr9b0K/O/QbtaeKbPvQmO2WCVCKQjOuIEHw1PAq/DdLQ7zA22jlLvagWKDevub8gB3gyoYkoRzwCsJqnUGSE2wUqrtm67YuoJIKn6kjVDnDpeSW+yCo+YUSfO+7a72DQAOd2QeKNwNqj2BWgMtogt4x8o1dhp3rSezT77v+ADsE1BthasVIeUGSsKlJYH3OkMX+JwIAIcWAHvgFDJIyKXFzTwVWaZAqyQX0OsuMDoReh2/7ExhYuYFka44kpa+0gVmJnDgQ9gnhf17iS9pyb/THNsBz5H30PQ/lWMISKcu6byuKkdfQtJxWHdoOhQnoAJXHVulbejLMRM4QrRoUn1/N2cd500qC+hqaw427cZGpepThBsdb05KBT4qRQk4BnSq3Wuq+nQe1igskHLDo4T4vKbJSC6QCoxeZanq9gT/iHxSc6q8YFci43f4FphE+ElywvQmnQskH3MzV/Cc4AP+FjPuzkFscoddiUxJSNbwHOZdBsYNspm4+bvZu9YJ/h77G5UNzt8Rksxf6/W9EeEkuCu0ZfK0G/QlrTN7gmfxUguY3GrjDBLuAfwA8HMloCJBXcLdIS2Zb+IEzET7pH09AtNdGcd8xrgkpvKCv1q/W8ErCXeBAM4nBcXWFZSALvjpocVGwOvJsJ/6ALu4weePKYo+YKf1nzi0Ao8JukJ0y6NijRagJGhp2S0g7cr8uEtreCxmJCtJzzKY/sI+EWoFujIoeF8RynxgIzcXjF1Aq63V/rsDf8zBCIOqBkG2yg1SMKziwEFVWEngSYoHwWsc/kAh/djBTV9reH5CDPkekqzngvfYJ4KtImAmCLYuoBawYFdX568xvGK82PvplEfBKwGJND0apyuw3Vt7QM4Qjw6C1L6ToIB835/23Q6EBPjxeEdAOh4nEU7IzDLYborSKqBuQJAkgFaQCFCyOAmC8AKmn/L6u55rKBGeEnta3Gmf31W6AOzBRAJwCDwlTTTjqm5fEeAk0MT9MIT3SFTl/w5+T6ogqCtCImGWgJkTGxTvVz+S0uYbos7vp4PggkNzSVWebt+gfnzJn8l1B6L6g8rO/8tMsCKgKnH5M9Xkq1+LJgKYDzAg+lipd+CdBQwJUBL04c4CdOPECfB8Xs8U9cSmIyDVHlLlKWl8tOwNN0PxoYKEZP6eNL3nj6UrjY/qg0MCZkjowPshSXd4kQhwEpQIt44Eehp8R0BHBFeFNOErIUEzyJRAdQS4aykRCXAHulLmkID0IuMD21bucTIkwTWeTmrT9zkBDrLqU7Ar13/KyAK6lz1v0A2UnyOmI6xqTAdQgawifLouZYYADsbJq9Yh14vdr05oR8dpFQkz99IYrRzzf4Nv7yCftiaQVe/XQF6uUl995p9PySkEvL1r/SnXSap1e3R9EpBzCNgbp7ju7s1IFYi7z4+S2RgwktGkLknAReV//1ZfpUoh3WQAAAAASUVORK5CYII="}return kt}const Et=C.prototype.draw;class Tt extends C{draw(e={}){var t,a;const n=this.gl.renderer.state.viewport,o=null!=(t=null==n?void 0:n.width)?t:1e3,l=null!=(a=null==n?void 0:n.height)?a:1e3;this.program.uniforms.viewport={value:[o,l]},Et.call(this,e)}}function St(e,t){const{colors:a,opacities:n,positions:o,randoms:l,sizes:i,texture:s}=t,r=new x(e,{color:{size:3,data:a},opacity:{size:1,data:n},position:{size:3,data:o},random:{size:1,data:l},size:{size:1,data:i}}),c=new b(e,{vertex:"attribute vec3 position;attribute vec3 color;attribute float opacity;attribute float random;attribute float size;uniform mat4 modelViewMatrix;uniform mat4 projectionMatrix;uniform vec2 viewport;varying vec4 vColor;varying float vRandom;void main(){vColor=vec4(color,opacity);vRandom=random;float scale=viewport.y*projectionMatrix[1][1]/900.0;gl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.0);gl_PointSize=size*scale/length(gl_Position);}",fragment:"precision mediump float;uniform sampler2D uTexture;varying vec4 vColor;varying float vRandom;void main(){vec2 coord=gl_PointCoord-0.5;float random=vRandom*3.14;float cosr=cos(random);float sinr=sin(random);mat2 rmat=mat2(cosr,-sinr,sinr,cosr);gl_FragColor=vColor*texture2D(uTexture,coord*rmat+0.5);}",uniforms:{uTexture:{value:s}},transparent:!0,depthTest:!1});return new Tt(e,{mode:e.POINTS,geometry:r,program:c})}async function Bt(e){return await Promise.all(Xe.data.map((t=>async function(e,t){const{points:a,rotationY:n,rotationX:o}=t,l=Math.floor(a.length/3),i=At(e),s=()=>function(e,t,a){const n=new u(e).map((e=>e*a)),o=new u(t).map((e=>e*(1-a)));return n.map(((e,t)=>e+o[t]))}(16777215,7595007,Math.random()),r=new Float32Array(3*l),c=new Float32Array(l),p=new Float32Array(l),d=new Float32Array(l);for(let u=0;u<l;u+=1)r.set(s(),3*u),c.set([1],u),p.set([0],u),d.set([60],u);const v=St(e,{positions:a,colors:r,opacities:c,randoms:p,sizes:d,texture:i});return v.rotation.x+=o,v.rotation.y+=n,v}(e,t))))}function It(e){const t=new m;return async function(e,t){(await async function(e){const t=new y(e,{radius:20,widthSegments:32}),a=yt(e),n=new b(e,{vertex:"precision highp float;precision highp int;attribute vec2 uv;attribute vec3 position;attribute vec3 normal;uniform mat4 modelViewMatrix;uniform mat4 projectionMatrix;varying vec2 vUv;void main(){vUv=uv;gl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.0);}",fragment:"precision highp float;precision highp int;uniform sampler2D tMap;varying vec2 vUv;void main(){vec3 tex=texture2D(tMap,vUv).rgb;gl_FragColor.rgb=tex;gl_FragColor.a=1.0;}",uniforms:{tMap:{value:a}},cullFace:!1}),o=new C(e,{geometry:t,program:n});return o.rotation.x=-.2,o.rotation.z=-.2,[o]}(e)).map((e=>e.setParent(t))),(await Bt(e)).map((e=>e.setParent(t)))}(e,t),t}async function qt(e){return(await Promise.all(Xe.data.map((t=>async function(e,t){const{points:a,lines:n,rotationY:o,rotationX:l}=t,i=Math.floor(a.length/3),s=At(e),r=new Float32Array(3*i),c=new Float32Array(i),u=new Float32Array(i),p=new Float32Array(i);for(let h=0;h<i;h+=1)r.set(Ft,3*h),c.set([1],h),u.set([0],h),p.set([80],h);const d=St(e,{positions:a,colors:r,opacities:c,randoms:u,sizes:p,texture:s}),v=function(e,t){const{positions:a,color:n,opacity:o}=t,l=new x(e,{position:{size:3,data:a}}),i=new b(e,{vertex:"attribute vec3 position;uniform mat4 modelViewMatrix;uniform mat4 projectionMatrix;uniform mat4 viewMatrix;void main(){gl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.0);}",fragment:"precision mediump float;uniform vec4 uColor;void main(){gl_FragColor=uColor;}",uniforms:{uColor:{value:[...n,o]}},transparent:!0,depthTest:!1});return new C(e,{mode:e.LINES,geometry:l,program:i})}(e,{positions:n,color:Ft,opacity:1});return[d,v].map((e=>(e.rotation.x+=l,e.rotation.y+=o,e)))}(e,t))))).reduce(((e,t)=>e.concat(t)),[])}const Ft=new u(7783679);function Pt(e){const t=new m;return async function(e,t){(await qt(e)).map((e=>e.setParent(t)))}(e,t),t}function jt(e){const t=new M(e);return t.addPass({fragment:"precision highp float;uniform sampler2D tMap;uniform vec3 uBalance;varying vec2 vUv;void main(){vec3 tex=texture2D(tMap,vUv).rgb;gl_FragColor.rgb=tex*uBalance;gl_FragColor.a=1.0;}",uniforms:{uBalance:{value:new p(1,1,1)}}}),t.addPass({fragment:"precision highp float;uniform sampler2D tMap;varying vec2 vUv;void main(){vec3 tex=texture2D(tMap,vUv).rgb;float r=tex.r;float g=tex.g;float b=tex.b;float cMin=min(min(r,g),b);float cMax=max(max(r,g),b);float cAverage=(r+g+b)/3.0;tex=vec3((cMin+cMax+cAverage)/3.0);gl_FragColor.rgb=tex;gl_FragColor.a=1.0;}"}),t}var Dt="_starry_4sdmm_1",Lt=o({name:"TheStarrySky",setup(){const e=l(),a=d((()=>{if(e.value)return new k({canvas:e.value,preserveDrawingBuffer:!0,antialias:!0})})),n=d((()=>{if(!a.value)return;const e=a.value.gl;return e.clearColor(0,0,0,1),e})),o=d((()=>{if(n.value)return It(n.value)})),r=d((()=>{if(n.value&&o.value)return Pt(n.value)})),c=d((()=>{if(n.value)return new A(n.value)})),u=d((()=>{if(!n.value)return;const e=new A(n.value);return e.scale.y=-1,e})),p=d((()=>{if(n.value)return jt(n.value)})),h=d((()=>{if(n.value)return jt(n.value)}));return v((()=>({renderer:a.value,w:Ce.full.w,h:Ce.full.h})),(({renderer:e,w:t,h:a})=>{null==e||e.setSize(t,a)})),v((()=>{const{full:e,camera:t}=Ce,{w:a,h:o,offsetX:l,offsetY:i}=t;return{gl:n.value,x:(e.w-a)/2+l,y:(e.h-o)/2-i,w:a,h:o}}),(({gl:e,x:t,y:a,w:n,h:o})=>{null==e||e.scissor(t,a,n,o)})),v((()=>{const{w:e,h:t,fov:a}=Ce.full;return{camera:c.value,aspect:e/t,fov:180*a/Math.PI}}),(({camera:e,aspect:t,fov:a})=>{null==e||e.perspective({fov:a,aspect:t})})),v((()=>{const{w:e,h:t,fov:a}=Ce.photo;return{camera:u.value,aspect:e/t,fov:180*a/Math.PI}}),(({camera:e,aspect:t,fov:a})=>{null==e||e.perspective({fov:a,aspect:t})})),v((()=>({post:p.value,w:Ce.full.w,h:Ce.full.h})),(({post:e,w:t,h:a})=>{null==e||e.resize({width:t,height:a})})),v((()=>({post:h.value,w:Ce.photo.w,h:Ce.photo.h})),(({post:e,w:t,h:a})=>{null==e||e.resize({width:t,height:a})})),v((()=>({post:p.value,postView:h.value,balance:ge.balance,desaturate:ge.desaturate})),(({post:e,postView:t,balance:a,desaturate:n})=>{const o=e=>{if(!e)return;const[t,o]=e.passes;t.uniforms.uBalance.value=a,o.enabled=n};o(e),o(t)})),function(e){const t=l(),a=()=>{t.value=requestAnimationFrame(a),e()};i((()=>a())),s((()=>t.value&&cancelAnimationFrame(t.value)))}((()=>{const e=n.value,t=a.value,l=o.value,i=r.value,s=c.value,u=p.value;e&&t&&s&&u&&(s.rotation.copy(Fe.camera.rotation),ne.isMobileInCSS||(e.disable(e.SCISSOR_TEST),ge.frontCamera&&(s.rotation.y+=Math.PI,s.rotation.x*=-1),t.render({camera:c.value,scene:o.value}),ge.frontCamera&&(s.rotation.y-=Math.PI,s.rotation.x*=-1)),e.enable(e.SCISSOR_TEST),u.render({camera:s,scene:l}),ge.visible.constellation&&t.render({camera:s,scene:i,clear:!1}))})),v((()=>ge.state),(e=>{e===he.TAKING&&new Promise((async(e,t)=>{const l=n.value,i=a.value,s=o.value,p=r.value,d=c.value,v=u.value,m=h.value;if(!(l&&i&&d&&v&&m))return t();v.rotation.copy(d.rotation);const{w:f,h:g,offsetX:w,offsetY:_,outputW:y,outputH:b}=Ce.photo,C=new E(l,{width:f,height:g});l.disable(l.SCISSOR_TEST),m.render({camera:v,scene:s,target:C}),ge.visible.constellation&&i.render({camera:v,scene:p,target:C,clear:!1});const x=new Uint8Array(y*b*4);l.bindFramebuffer(l.FRAMEBUFFER,C.buffer),l.readPixels(Math.max(0,w),Math.max(0,_),y,b,l.RGBA,l.UNSIGNED_BYTE,x),l.bindFramebuffer(l.FRAMEBUFFER,null);const M=ee(new ImageData(new Uint8ClampedArray(x),y,b)),k=await te(M);e({src:URL.createObjectURL(k),w:M.width,h:M.height})})).then((e=>Ue.pushPhoto(e))).finally((()=>{ge.setState(he.NO_STATUS)}))})),()=>t("canvas",{class:Dt,ref:e},null)}});var Yt="_focus_7lopp_1",Rt="_info_7lopp_43";const{near:zt,far:Xt}=X.constellation;var Ot=o({name:"TheFoucs",props:{onClick:{type:Function}},setup(e){const a=d((()=>{const e=200*X.constellation.scale,{x:t}=Fe.toPx(e,0,zt);return t})),n=d((()=>{const e=Xe.focus;if(!e)return;const t=Fe.camera.rotation,{x:n,y:o,z:l}=new p(0,0,-Xt).applyMatrix4((new T).rotate(e.rotationX-t.x,[1,0,0]).rotate(e.rotationY-t.y,[0,1,0])),{x:i,y:s}=Fe.toPx(n,o,Math.abs(l)),r=a.value;return{width:`${r}px`,height:`${r}px`,transform:`translate(${-r/2+i}px, ${-r/2+s}px)`}}));let o=!1;const l=()=>{o=!0},i=()=>{o=!1,addEventListener("mousemove",l,{once:!0})},s=()=>{removeEventListener("mousemove",l)};return()=>{const a=Xe.focus;return a?t("div",f({class:Yt,title:a.title,style:n.value},de,{onClick:t=>{var a;de.onClick(t),o||null==(a=e.onClick)||a.call(e)},onMousedown:i,onMouseup:s}),[t("span",null,null),t("span",null,null),t("span",null,null),t("span",null,null)]):null}}}),Ut=o({name:"TheFoucsInfo",props:{onClick:{type:Function}},setup:e=>()=>{const a=Xe.focus;return a?t("div",{class:Rt},[t("div",f({title:a.title},de,{onClick:t=>{var a;de.onClick(t),null==(a=e.onClick)||a.call(e)}}),[a.title])]):null}});var Vt="_overlay_gq57q_1",Kt="_mask_gq57q_2",Qt="_container_gq57q_3",Nt="_table_gq57q_24",Jt="_table-cell_gq57q_30",Ht="_enter--active_gq57q_35",Wt="_enter--from_gq57q_39",Gt="_enter--to_gq57q_43";let Zt=0;const $t=r([]);!function(){const e=document.body;let t,a=0;v((()=>$t.length),(n=>{!n!=!a&&(n?(t=e.style.overflow,e.style.overflow="hidden"):e.style.overflow=t,a=n)}))}();var ea=o({name:"Overlay",props:{visible:{type:Boolean,default:!1},maskColor:{type:String,default:"rgba(0, 0, 0, 0.35)"},onMaskClick:{type:Function}},setup(e,{slots:a}){const n={container:l(),cell:l()},o=Zt++,i=()=>{const e=$t.indexOf(o);~e&&$t.splice(e,1)};s(i),v((()=>e.visible),(e=>e?$t.push(o):i()),{immediate:!0});let r=!1;const c=e=>{e.target===n.cell.value&&(r=!0)},u=e=>{r&&e.target!==n.cell.value&&(r=!1)},p=t=>{var a;r&&(r=!1,t.target===n.cell.value&&(null==(a=e.onMaskClick)||a.call(e,t)))};let d=0;const h=e=>{const t=e.touches[0];t&&(d=t.pageY)},m=e=>{if(!e.cancelable)return;const t=e.touches[0],a=n.container.value;if(!t||!a)return;const{clientHeight:o,scrollTop:l,scrollHeight:i}=a;d<t.pageY?l<=0&&e.preventDefault():d>t.pageY&&l>=i-o&&e.preventDefault()};return()=>t(S,{to:O.overlay},{default:()=>[t(g,{enterActiveClass:Ht,enterFromClass:Wt,enterToClass:Gt,leaveActiveClass:Ht,leaveFromClass:Gt,leaveToClass:Wt},{default:()=>{var l;if(!e.visible)return null;const i=$t[$t.length-1]===o;return t("div",{class:Vt},[i?t("div",{class:Kt,style:{backgroundColor:e.maskColor}},null):null,t("div",{ref:n.container,class:Qt,style:{overflow:i?void 0:"hidden"}},[t("div",{class:Nt},[t("div",{ref:n.cell,class:Jt,onMousedown:c,onMousemove:u,onMouseup:p,onTouchstart:h,onTouchmove:m},[null==(l=a.default)?void 0:l.call(a)])])])])}})]})}});var ta="_popup_qtxwv_6",aa="_header_qtxwv_27",na="_close_qtxwv_44",oa="_scale--active_qtxwv_93",la="_scale--from_qtxwv_98",ia="_scale--to_qtxwv_102",sa="_slide--active_qtxwv_106",ra="_slide--from_qtxwv_110",ca="_slide--to_qtxwv_114",ua=o({name:"Popup",props:{visible:{type:Boolean,default:!1},maskColor:{type:String},onMaskClick:{type:Function},onCloseClick:{type:Function},title:{type:String},startTarget:{type:Object},popupClass:{type:String},transition:{type:String,default:"slide"},fullscreen:{type:String,default:"none"}},setup(e,{slots:a}){const n=function(e){const t=r({overlay:e(),content:e()});return v(e,(e=>{e?(t.overlay=e,w((()=>t.content=e))):(t.content=e,w((()=>t.overlay=e)))})),t}((()=>e.visible)),o=l(),i=()=>{const t=e.startTarget,a=o.value;if(a)if(t){const e=t.getBoundingClientRect(),n=a.getBoundingClientRect();pa(a,`${e.left-n.left}px ${e.top-n.top}px`)}else pa(a,null)};v((()=>e.visible),(e=>{e?w((()=>w(i))):i()}));const s=d((()=>{switch(e.transition){case"scale":return{enterActiveClass:oa,enterFromClass:la,enterToClass:ia,leaveActiveClass:oa,leaveFromClass:ia,leaveToClass:la};default:return{enterActiveClass:sa,enterFromClass:ra,enterToClass:ca,leaveActiveClass:sa,leaveFromClass:ca,leaveToClass:ra}}}));return()=>t(ea,{visible:n.overlay,maskColor:e.maskColor,onMaskClick:e.onMaskClick},{default:()=>t(g,s.value,{default:()=>{var l;return n.content?t("div",{class:[ta,e.popupClass],ref:o,"data-fullscreen":e.fullscreen},[t("div",{class:aa},[e.title,t("div",{title:"关闭",class:na,onClick:e.onCloseClick},[t(Qe,{value:"close"},null)])]),null==(l=a.default)?void 0:l.call(a)]):null}})})}});function pa(e,t){const a=e.style;["WebkitTransformOrigin","MozTransformOrigin","Ms","msTransformOrigin","transformOrigin"].forEach((e=>a[e]=t))}var da=o({name:"Swiper",props:{items:{type:Array,default:[]},options:{type:Object,default:{}},onClose:{type:Function}},setup(a){const n=l();return i((()=>function(){if(!n.value)return;const t=new B(n.value,I,a.items,e({history:!1,shareEl:!1,fullscreenEl:!1,showHideOpacity:!0},a.options));(function(e){e.listen("imageLoadComplete",((t,a)=>{const n=new Image;n.src=a.src,n.onload=()=>{a.w=n.width,a.h=n.height,e.updateSize(!0)}})),e.listen("destroy",(()=>{var e;return null==(e=a.onClose)?void 0:e.call(a)}))})(t),t.init()}())),()=>t(S,{to:"#overlay"},{default:()=>[t("div",{class:"pswp",tabindex:-1,role:"dialog","aria-hidden":"true",ref:n},[t("div",{class:"pswp__bg"},null),t("div",{class:"pswp__scroll-wrap"},[t("div",{class:"pswp__container"},[t("div",{class:"pswp__item"},null),t("div",{class:"pswp__item"},null),t("div",{class:"pswp__item"},null)]),t("div",{class:"pswp__ui pswp__ui--hidden"},[t("div",{class:"pswp__top-bar"},[t("div",{class:"pswp__counter"},null),t("button",{class:"pswp__button pswp__button--close",title:"Close (Esc)"},null),t("button",{class:"pswp__button pswp__button--share",title:"Share"},null),t("button",{class:"pswp__button pswp__button--fs",title:"Toggle fullscreen"},null),t("button",{class:"pswp__button pswp__button--zoom",title:"Zoom in/out"},null),t("div",{class:"pswp__preloader"},[t("div",{class:"pswp__preloader__icn"},[t("div",{class:"pswp__preloader__cut"},[t("div",{class:"pswp__preloader__donut"},null)])])])]),t("div",{class:"pswp__share-modal pswp__share-modal--hidden pswp__single-tap"},[t("div",{class:"pswp__share-tooltip"},null)]),t("button",{class:"pswp__button pswp__button--arrow--left",title:"Previous (arrow left)"},null),t("button",{class:"pswp__button pswp__button--arrow--right",title:"Next (arrow right)"},null),t("div",{class:"pswp__caption"},[t("div",{class:"pswp__caption__center"},null)])])])])]})}});var va="_popup_vqe1c_8",ha="_album_vqe1c_12",ma="_item_vqe1c_18",fa="_none_vqe1c_32",ga=o({name:"TheAlbum",props:{},setup(){const o=l(),i=r({visible:!1,index:0}),s=d((()=>Ue.photos.map((t=>e({},t))))),c=e=>{if(!o.value)return;const t=o.value.children,a=s.value[e],n=window.pageYOffset||document.documentElement.scrollTop,l=t[e];if(!l)return;const i=l.getBoundingClientRect();let r=i.left,c=i.top+n,{w:u,h:p}=a;return u>p?(u=u*i.height/p,p=i.height,r-=(u-p)/2):(p=p*i.width/u,u=i.width,c-=(p-u)/2),{x:r,y:c,w:u}};return()=>t(ua,{title:"相册",visible:ge.visible.album,startTarget:Ue.buttonElement,popupClass:va,transition:"scale",fullscreen:"mobile",onMaskClick:()=>ge.setVisible("album",!1),onCloseClick:()=>ge.setVisible("album",!1)},{default:()=>t(n,null,[t("div",{class:ha,ref:o},[Ue.photos.map((({msrc:e},a)=>t("div",{class:ma,key:e},[t("div",{onClick:()=>{i.visible=!0,i.index=a},style:{backgroundImage:`url(${e})`}},null)]))),0===Ue.photos.length?t("div",{class:fa},[a("这里空空如也")]):null]),i.visible?t(da,{items:s.value,options:{getThumbBoundsFn:c,index:i.index},onClose:()=>i.visible=!1},null):null])})}});var wa="_slider_195i1_1",_a="_rail_195i1_10",ya="_track_195i1_13",ba="_handle_195i1_16",Ca=o({name:"Slider",props:{value:{type:Number,default:0},min:{type:Number,default:0},max:{type:Number,default:100},step:{type:Number,default:1},onChange:{type:Function}},setup(e){const a={slider:l(),handle:l()},n=r({value:0,percentage:0}),o=t=>{const a=e.min,n=e.max,o=e.step;let l=Math.max(Math.min(t,n),a);return l=Math.round(l/o)*o,l};v((()=>({value:e.value,min:e.min,max:e.max})),(({value:e})=>{n.value=o(e)}),{immediate:!0}),v((()=>n.value),(t=>{n.percentage=(t-e.min)/(e.max-e.min)}),{immediate:!0});const i=(t,a)=>{const n=a.getBoundingClientRect(),l=window.pageXOffset+n.left,i=(t-l)/(l+n.width-l);return o(e.min+i*(e.max-e.min))};function s(t){var n;if(!a.slider.value)return;const o=i(t,a.slider.value);null==(n=e.onChange)||n.call(e,o)}function c(t){var n;if(!a.slider.value)return;const o=i(t,a.slider.value);null==(n=e.onChange)||n.call(e,o)}function u(e){if(0!==e.button)return;s(xa(e)),document.addEventListener("mousemove",p),document.addEventListener("mouseup",d)}function p(e){c(xa(e))}function d(e){document.removeEventListener("mousemove",p),document.removeEventListener("mouseup",d)}function h(e){s(Ma(e)),document.addEventListener("touchmove",m),document.addEventListener("touchend",f)}function m(e){c(Ma(e))}function f(e){document.removeEventListener("touchmove",m),document.removeEventListener("touchend",f)}return()=>t("div",{ref:a.slider,class:wa,onMousedown:u,onTouchstart:h,onDragstart:e=>e.preventDefault()},[t("div",{class:_a},null),t("div",{class:ya,style:{width:100*n.percentage+"%"}},null),t("div",{ref:a.handle,class:ba,style:{left:100*n.percentage+"%"}},null)])}});function xa(e){let t=1;return window.visualViewport&&(t=+(window.visualViewport.width/document.body.getBoundingClientRect().width).toFixed(2)),e.pageX/t}function Ma(e){let t=1;return window.visualViewport&&(t=+(window.visualViewport.width/document.body.getBoundingClientRect().width).toFixed(2)),e.touches[0].pageX/t}var ka="_switch_m9sms_1",Aa=o({name:"Switch",props:{value:{type:Boolean,default:!1},onChange:{type:Function}},setup(e){const a=()=>{var t;null==(t=e.onChange)||t.call(e,!e.value)};return()=>t("div",{class:ka,"data-active":e.value,onClick:a},null)}});var Ea="_balance_1qpfq_6",Ta="_row_1qpfq_6",Sa="_label_1qpfq_12",Ba="_content_1qpfq_17";var Ia=o({name:"TheBalance",setup:()=>()=>t(ua,{title:"色彩平衡",popupClass:Ea,visible:ge.visible.balance,maskColor:"transparent",onMaskClick:()=>ge.setVisible("balance",!1),onCloseClick:()=>ge.setVisible("balance",!1)},{default:()=>t(n,null,[["R","G","B"].map(((e,a)=>t("div",{class:Ta},[t("div",{class:Sa},[e]),t("div",{class:Ba},[t(Ca,{value:ge.balance[a],onChange:e=>((e,t)=>{const a=ge.balance.clone();a[t]=e,ge.setBalance(a)})(e,a),min:0,max:2,step:.05},null)])]))),t("div",{class:Ta},[t("div",{class:Sa},[a("去色")]),t("div",{class:Ba},[t(Aa,{value:ge.desaturate,onChange:ge.setDesaturate,style:{display:"block",marginLeft:"0.24rem"}},null)])])])})}),qa=o({name:"Constellation",props:{points:{type:Array,required:!0},lines:{type:Array,required:!0}},setup(e){const a=d((()=>{const t=[],{points:a}=e;for(let e=0;e<a.length;e+=2){const n=Fa([a[e],a[e+1]]);t.push(n)}return t})),n=d((()=>{const t=[],{lines:a}=e;for(let e=0;e<a.length;e+=2)t.push([a[e],a[e+1]]);return t}));return()=>t("svg",f({viewBox:"-100 -100 200 200",version:"1.1"},{xmlns:"http://www.w3.org/2000/svg"}),[a.value.map((([e,a])=>t("circle",{cx:e,cy:a,r:"4",fill:"currentColor"},null))),n.value.map((([e,n])=>{var o,l;const i=a.value,[s,r]=null!=(o=i[e])?o:[],[c,u]=null!=(l=i[n])?l:[];return t("line",{x1:s,y1:r,x2:c,y2:u,stroke:"currentColor",fill:"transparent","stroke-width":"2"},null)}))])}});function Fa([e,t]){return[e,-t]}var Pa="_constellation_1cwer_7",ja="_card_1cwer_11",Da="_logo_1cwer_20",La="_content_1cwer_27",Ya="_title_1cwer_31",Ra="_description_1cwer_36",za="_link_1cwer_42",Xa=o({name:"ConstellationInfoCard",props:{data:{type:Object,required:!0}},setup(e){const n=l(e.data.points),o=d((()=>"关于我"===e.data.title)),i=()=>{const e=q(n.value),t=L.filter((t=>t!==e));if(!t.length)return;const a=Math.floor(Math.random()*t.length);n.value=t[a]};return()=>t("div",{class:ja},[e.data.url?t("a",{href:e.data.url,class:Da,target:"blank"},[t(qa,{points:e.data.points,lines:e.data.lines},null)]):t("div",{class:Da,style:o.value?{cursor:"pointer"}:void 0,onClick:o.value?i:void 0},[t(qa,{points:n.value,lines:e.data.lines},null)]),t("div",{class:La},[t("div",{class:Ya},[e.data.title]),t("div",{class:Ra},[e.data.description]),e.data.url?t("div",{class:za},[t("a",{href:e.data.url,target:"blank"},[a("Link Start")])]):null])])}});var Oa="_list_1owqo_7",Ua=o({name:"TheList",setup:()=>()=>t(ua,{title:"星座图鉴列表",popupClass:Oa,visible:ge.visible.list,onMaskClick:()=>ge.setVisible("list",!1),onCloseClick:()=>ge.setVisible("list",!1)},{default:()=>D.map((e=>t(Xa,{data:e},null)))})});var Va="_notification_13hu3_1",Ka="_message_13hu3_11",Qa="_enter--active_13hu3_21",Na="_enter--from_13hu3_25",Ja="_enter--to_13hu3_29",Ha=o({name:"TheNotification",setup(){const e=r({text:"",active:!1});let a;return v((()=>e.text),(t=>{clearTimeout(a),""!==t&&(a=setTimeout((()=>e.text=""),1e3))})),s((()=>clearTimeout(a))),v((()=>ge.delay),(t=>{t?(e.text=`延时 ${Math.floor(t/1e3)} 秒`,e.active=!0):(e.text="延时已关闭",e.active=!1)})),v((()=>ge.visible.constellation),(t=>{t?(e.text="显示星座",e.active=!0):(e.text="隐藏星座",e.active=!1)})),v((()=>ge.frontCamera),(t=>{e.active=!1,e.text=(t?"前置":"后置")+"摄像头"})),()=>t(g,{enterActiveClass:Qa,enterFromClass:Na,enterToClass:Ja,leaveActiveClass:Qa,leaveFromClass:Ja,leaveToClass:Na},{default:()=>e.text&&t("div",{class:Va},[t("span",{class:Ka,"data-active":e.active},[e.text])])})}}),Wa=o({name:"ConstellationInfo",props:{visible:{type:Boolean,default:!1},index:{type:Number},onMaskClick:{type:Function},onCloseClick:{type:Function}},setup(e){const a=d((()=>{var t,a;return null!=(a=D[null!=(t=e.index)?t:0])?a:D[0]}));return()=>t(ua,{title:"星座图鉴",popupClass:Pa,visible:e.visible,onMaskClick:e.onMaskClick,onCloseClick:e.onCloseClick},{default:()=>a.value?t(Xa,{data:a.value},null):null})}});F(o((()=>{i((()=>$removeLoading()));const e=r({index:-1}),a=()=>{const t=Xe.data.indexOf(Xe.focus);e.index=t};return()=>t(n,null,[t(Lt,null,null),t(Z,null,{default:()=>t(n,null,[t(gt,null,{default:()=>t(n,null,[t(Ha,null,null),t(Ut,{onClick:a},null)])}),t(Ot,{onClick:a},null)])}),t(ga,null,null),t(Ia,null,null),t(Ua,null,null),t(Wa,{visible:!!~e.index,index:e.index,onMaskClick:()=>e.index=-1,onCloseClick:()=>e.index=-1},null)])}))).mount(O.root);
